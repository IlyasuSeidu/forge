# Forge

**Production-grade AI application factory: Natural language â†’ Working apps with guaranteed quality**

ğŸ”— **Repository**: [https://github.com/IlyasuSeidu/forge](https://github.com/IlyasuSeidu/forge)

> *"This is not agent soup. This is an assembly line."*

---

## ğŸš€ What is Forge?

Forge is a **production-grade system** that transforms natural-language ideas into fully built, verified applications using a specialized assembly line of 17 AI agents.

Unlike other AI code generators that ship broken code silently, Forge **guarantees quality** through:
- âœ… **Production-ready mockups** via VCRA + Playwright (perfect text rendering, real code)
- âœ… **Automated verification** before marking apps complete
- âœ… **Self-healing** with up to 5 automatic repair attempts
- âœ… **6 strategic human approval gates** for quality control
- âœ… **Hash-chain immutability** for complete traceability
- âœ… **Phase 10 frozen invariants** that can never be weakened

---

## ğŸ“Š Current Status

**Production-Grade 17-Agent Assembly Line** (Updated: January 14, 2026)

### âš¡ Recent Transformations (Jan 10-13, 2026)

#### **Day 1: Phase 10 Quality Assurance** (Jan 10-11)
- âœ… Static verification engine (DOM/file integrity)
- âœ… Self-healing with RepairAgent (bounded to 5 attempts)
- âœ… **Five Sacred Invariants** frozen forever
- âœ… Human escalation with friendly error summaries

#### **Day 2: Tier System Revolution** (Jan 11)
- âœ… **12-agent framework** organized in 5 tiers
- âœ… Forge Conductor (state machine orchestrator)
- âœ… Journey Orchestrator determinism fix (10/10 tests)
- âœ… Build Prompt Engineer with execution contracts
- âœ… Hash chain integrity across all artifacts

#### **Day 3: Visual Intelligence & VCRA Revolution** (Jan 12-13)
- âœ… **Visual Rendering Authority (Tier 3.5)** - Deterministic visual expansion
- âœ… **Deterministic Visual Normalizer (Tier 3.5)** - Prevents visual maximalism
- âœ… **Visual Composition Authority (Tier 3.5)** - HOW screens are composed
- âœ… **Visual Code Rendering Authority (Tier 3.75)** - Real HTML/React code generation ğŸ†•
- âœ… **Playwright Integration** - Headless browser rendering replaces DALL-E
- âœ… Perfect text rendering (no AI blur or hallucination)
- âœ… **Build Prompt Engineer Hardened** - Constitutional authority with MBOM pattern ğŸ†•
- âœ… 10/10 test pass rate across all hardened agents
- âœ… Production-ready code for implementation (40-60% time savings)

#### **Day 4: Phase 10 Constitutional Hardening** (Jan 13)
- âœ… **Verification Executor Hardened (Tier 5.0)** - Adversarial truth engine with ZERO intelligence
- âœ… **Verification Report Generator Hardened (Tier 5.5)** - Pure projection with ZERO judgment
- âœ… Completion Auditor integration with VerificationResult evidence
- âœ… E2E test with real verification (not simulated)
- âœ… Full hash chain: Rules â†’ BuildPrompt â†’ ExecutionPlan â†’ ExecutionLog â†’ VerificationResult â†’ CompletionReport
- âœ… 10/10 constitutional tests for Verification Executor
- âœ… 10/10 constitutional tests for Verification Report Generator

#### **Day 5: Phase 10 Complete + Constitutional Audit** (Jan 14) ğŸ†•
- âœ… **Repair Plan Generator** - Human-in-the-loop decision support (ZERO autonomous code generation)
- âœ… **Repair Agent Hardened (Tier 5.75)** - Bounded repair executor with constitutional safety
- âœ… **Phase 10 Constitutional Loop Test** - End-to-end validation PASSING (all 8 steps)
- âœ… **Constitutional Audit Framework** - Comprehensive validation of all 17 agents
- âœ… **AUDIT VERDICT: FORGE IS CONSTITUTIONALLY SOUND** - Ready for productization
- âœ… 10/10 constitutional tests for Repair Agent Hardened
- âœ… Complete hash chain verified: Base Prompt â†’ ... â†’ Repair Execution â†’ Re-verification â†’ Completion
- âœ… Critical safety invariant proven: Even malicious LLM plugged in = system remains safe
- âœ… **17-agent assembly line complete and production-ready**

### ğŸ¯ What's Fully Implemented

**Core Infrastructure:**
- âœ… Fastify backend with TypeScript strict mode
- âœ… SQLite + Prisma ORM with full migrations
- âœ… React 18 Web UI with approval interface
- âœ… Workspace isolation with path validation
- âœ… Complete audit trail via event logging

**17-Agent Assembly Line:**
- âœ… **Tier 1**: Foundry Architect + Synthetic Founder
- âœ… **Tier 2**: Product Strategist + Screen Cartographer + Journey Orchestrator
- âœ… **Tier 3**: Visual Rendering Authority + DVNL + VCA + VCRA + Visual Forge + Constraint Compiler
- âœ… **Tier 4**: Build Prompt Engineer + Execution Planner + Forge Implementer + Completion Auditor
- âœ… **Tier 5**: Verification Executor + Verification Report Generator + Repair Plan Generator + Repair Agent + Forge Conductor
- âœ… All agents constitutionally validated âœ… Production-ready

**AI Integrations:**
- âœ… Claude Sonnet 4.5 (code generation + VCRA code generation)
- âœ… Playwright (headless Chromium for mockup rendering)

**Quality Guarantees:**
- âœ… Phase 10 Invariants (frozen 2026-01-11)
- âœ… Automated verification before completion
- âœ… Self-healing with bounded repair attempts
- âœ… Human approval gates (6 strategic checkpoints)
- âœ… Hash-chain immutability (SHA-256 per artifact)
- âœ… No silent failures - all errors visible to users

**Production Hardening:**
- âœ… PromptEnvelope validation (authority enforcement)
- âœ… Context isolation (hash-based artifact access)
- âœ… Determinism guarantees (temperature â‰¤ 0.3, stable serialization)
- âœ… Failure escalation (no silent fallbacks)
- âœ… 10/10 test coverage on hardened agents
- âœ… Constitutional authorities: VRA, DVNL, VCA, VCRA, Build Prompt Engineer, Verification Executor, Verification Report Generator
- âœ… Build Ledger tracking (file ownership + dependency conflicts)
- âœ… Closed-scope enforcement (explicit forbidden files)
- âœ… Ambiguous language rejection (no "maybe", "perhaps", "consider")
- âœ… Phase 10 constitutional verification (ZERO intelligence, ZERO judgment)

### ğŸ”„ What's Next

**Immediate:**
- Enhanced AI capabilities (multi-turn conversations, code validation)
- Task-level approvals (optional per-project gates)
- Dependency management (package.json generation)

**Short-term:**
- Authentication & authorization (user accounts, API keys)
- PostgreSQL migration (production database)
- Real-time updates (WebSocket/SSE)

**Long-term:**
- Metrics collection (OpenTelemetry tracing)
- Advanced verification rules
- Multi-agent collaboration patterns

---

## ğŸ—ï¸ The 17-Agent Assembly Line

Forge uses **specialized agents** organized in a 6-tier hierarchy. Each agent has a single, non-overlapping mandate.

### **Tier 1: Strategy & Intent** (Foundation)

| Agent | Role | Output |
|-------|------|--------|
| **Foundry Architect** | Interrogates ideas via 8 structured questions | `base_prompt.md` |
| **Synthetic Founder** | Provides AI-assisted answers to questions | `founder_answers.json` |

**Human Approval Gate #1** âœ‹ *Approve foundational assumptions*

---

### **Tier 2: Planning & Structure** (Strategy â†’ Blueprints)

| Agent | Role | Output |
|-------|------|--------|
| **Product Strategist** | Creates master & implementation plans | `master_plan.md`, `implementation_plan.md` |
| **Screen Cartographer** | Enumerates and describes UI screens | `screens/*.md` |
| **Journey Orchestrator** | Maps user roles and behavioral flows | `roles.json`, `journeys/*.md` |

**Human Approval Gate #2** âœ‹ *Confirm screen inventory*

**Key Feature**: All Tier 2 agents now deterministic with closed vocabularies and canonicalization (10/10 test pass rates)

---

### **Tier 3: Visual & Constraint** (Design & Rules)

| Agent | Role | Output | Model |
|-------|------|--------|-------|
| **Visual Rendering Authority** â­ | Deterministic visual expansion with closed vocabularies | `visual_contracts/*.json` | Claude Sonnet 4.5 |
| **Deterministic Visual Normalizer** | Constrains visual complexity to prevent maximalism | `normalization_contracts/*.json` | Claude Sonnet 4.5 |
| **Visual Composition Authority** | Decides HOW screens are visually composed | `composition_contracts/*.json` | Claude Sonnet 4.5 |
| **Visual Code Rendering Authority** ğŸ†• | Generates real HTML/React code from visual contracts | `code_contracts/*.json` + code | Claude Sonnet 4.5 |
| **Visual Forge** | Orchestrates VCRA + Playwright rendering | `mockups/*.png` (211 KB) | Playwright Chromium |
| **Constraint Compiler** | Produces binding development rules | `rules.md` | GPT-5 |

**Human Approval Gate #3** âœ‹ *Approve VRA expansion contracts*
**Human Approval Gate #3.5** âœ‹ *Approve DVNL normalization contracts*
**Human Approval Gate #3.7** âœ‹ *Approve VCA composition contracts*
**Human Approval Gate #4** âœ‹ *Approve visual mockups*
**Human Approval Gate #5** âœ‹ *Validate architecture rules*

**Visual Intelligence Pipeline (Jan 12-13, 2026)**:
```
VRA â†’ DVNL â†’ VCA â†’ VCRA â†’ Playwright â†’ Screenshot
WHAT  HOW MUCH  COMPOSED  CODE      PIXELS
```

**Visual Code Rendering Authority (NEW - Jan 13, 2026)** ğŸ†•:
- **Tier 3.75** - Final step before mockup rendering
- **Purpose**: Generates production-ready HTML+Tailwind or React+Tailwind code from visual contracts
- **Key Innovation**: Real browser rendering replaces DALL-E (perfect text, no AI hallucination)
- **Output**: `VisualCodeRenderingContract` with 21.5KB+ generated code
- **Performance**: 75s code generation + 3.9s Playwright rendering
- **Benefits**:
  - âœ… Perfect text rendering (no blur or hallucination)
  - âœ… Exact layout fidelity
  - âœ… Production-ready code for implementation (40-60% time savings)
  - âœ… Fully deterministic (same contracts = same code)
- **Status**: 10/10 tests passing with real Claude + Playwright integration

**Complete Visual Pipeline**:
1. **VRA** (Tier 3.5): Expands screens into explicit visual sections
2. **DVNL** (Tier 3.5): Constrains visual complexity (prevents maximalism)
3. **VCA** (Tier 3.5): Decides composition (section ordering, hierarchy, grouping)
4. **VCRA** (Tier 3.75): Generates real HTML/React code from all contracts
5. **Playwright**: Renders code in headless Chromium browser
6. **Screenshot**: Captures pixel-perfect mockup (211KB PNG)

---

### **Tier 4: Prompt & Execution** (Doing)

| Agent | Role | Output |
|-------|------|--------|
| **Build Prompt Engineer** (Hardened ğŸ†•) | Manufacturing Bill of Materials (MBOM) compiler | `BuildPromptContract` (hash-locked) |
| **Execution Planner** (Hardened ğŸ†•) | Factory Line Controller - deterministic task sequencing | `ExecutionPlanContract` (hash-locked) |
| **Forge Implementer** (Hardened ğŸ†•) | Robotic Executor - zero intelligence, zero interpretation | `ExecutionLog` (deterministic) |
| **Completion Auditor** (Hardened ğŸ†•) | Final Constitutional Gatekeeper - binary verdict only | `CompletionReport` (hash-locked) |

**Phase 10 Verification** ğŸ”’ *Automated quality checks + self-healing (max 5 attempts)*

**Human Approval Gate #6** âœ‹ *Escalation when verification fails after max attempts*

**Build Prompt Engineer Hardened (NEW - Jan 13, 2026)** ğŸ†•:
- **Authority**: MANUFACTURING_INSTRUCTION_AUTHORITY
- **Purpose**: Deterministic instruction compiler (WHAT, not HOW)
- **Contract Schema**: `BuildPromptContract` with hash-locked constraints
- **12 Forbidden Actions**: writeCode, modifyFiles, suggestImprovements, combineSteps, etc.
- **5 Allowed Actions**: generatePrompt, validateContract, trackLedger, emitEvents, pauseForApproval
- **Context Isolation**: Only reads hash-approved artifacts (status='approved' AND hash != null)
- **Determinism**: Same inputs â†’ same contractHash (SHA-256)
- **Build Ledger**: Tracks file ownership to prevent conflicts
- **Public API**: `start()`, `approve()`, `reject()`, `generateNext()`
- **Status**: 10/10 constitutional tests passing

**Execution Planner Hardened (NEW - Jan 13, 2026)** ğŸ†•:
- **Authority**: EXECUTION_PLANNING_AUTHORITY
- **Purpose**: Factory Line Controller - converts BuildPromptContracts to sequential task plans
- **Contract Schema**: `ExecutionPlanContract` with deterministic task ordering
- **11 Forbidden Actions**: writeCode, modifyCode, combineSteps, reorderSteps, optimizeTaskFlow, etc.
- **5 Allowed Actions**: generateExecutionPlan, validatePlanContract, trackTaskDependencies, emitEvents, pauseForApproval
- **Context Isolation**: Only reads hash-approved BuildPrompts and ProjectRuleSets
- **Determinism**: Same BuildPrompt â†’ same ExecutionPlan â†’ same contractHash
- **Task Sequencing**: Dependencies â†’ File Creates (alphabetical) â†’ File Modifies (alphabetical)
- **Validation**: Cycle detection (Kahn's algorithm), dependency validation, sequential task IDs
- **Public API**: `start()`, `approve()`, `reject()`, `generateNext()`
- **Status**: 10/10 constitutional tests passing

**Forge Implementer Hardened (NEW - Jan 13, 2026)** ğŸ†•:
- **Authority**: FORGE_IMPLEMENTATION_AUTHORITY
- **Purpose**: Robotic Executor - executes approved ExecutionPlanContracts exactly as written
- **Philosophy**: "This is a robot arm, not an agent. If it ever 'helps', the system is broken."
- **14 Forbidden Actions**: generateIdeas, interpretInstructions, modifyTaskOrder, skipTasks, combineTasks, retryFailedTasks, autoFixErrors, proceedAfterFailure, etc.
- **5 Allowed Actions**: executeTask, verifyOutcome, emitResult, haltOnFailure, loadHashLockedContext
- **Context Isolation**: MAXIMUM - only hash-locked ExecutionPlan, BuildPrompt, ProjectRuleSet
- **Execution Guarantees**: One task at a time, exact order, halt on failure, no retry, no rollback
- **Failure Handling**: Immediate halt, lock conductor, require human intervention
- **Determinism**: Same ExecutionPlan â†’ same ExecutionLog â†’ same logHash (excludes timestamps)
- **Public API**: `execute(planId)`, `getStatus(planId)`
- **Status**: 10/10 constitutional tests passing

**Completion Auditor Hardened (NEW - Jan 13, 2026)** ğŸ†•:
- **Authority**: COMPLETION_AUDIT_AUTHORITY (Final Gate)
- **Purpose**: Final Constitutional Gatekeeper - sole authority to declare COMPLETE or NOT_COMPLETE
- **Philosophy**: "If this agent is wrong, Forge is lying."
- **14 Forbidden Actions**: generateCode, modifyCode, suggestFixes, retryExecution, ignoreFailures, skipChecks, assumeIntent, declareMostlyComplete, etc.
- **5 Allowed Actions**: loadHashLockedArtifacts, compareHashes, compareCounts, compareStates, emitVerdict
- **9 Completion Checks**: Rule integrity, prompt integrity, execution integrity, log integrity, failure scan, verification integrity, artifact coverage, hash chain integrity, conductor final state
- **Binary Decision**: ALL checks pass â†’ COMPLETE, ANY check fails â†’ NOT_COMPLETE (no middle ground)
- **Determinism**: Same build state â†’ same CompletionReport â†’ same reportHash
- **Failure Philosophy**: "If Forge cannot prove completeness, it is incomplete."
- **Public API**: `audit(appRequestId)`, `getReport(appRequestId)`
- **Status**: 10/10 constitutional tests passing

---

### **Tier 5: Verification & Completion** (Quality Assurance)

| Agent | Role | Output |
|-------|------|--------|
| **Verification Executor** (Hardened âœ…) | Adversarial truth engine - mechanical verification | `VerificationResult` (hash-locked) |
| **Verification Report Generator** (Hardened âœ…) | Pure projection - human-readable reports | `VerificationReport` (hash-locked) |
| **Repair Plan Generator** (Hardened âœ…) | Decision support - proposes repair options (no autonomous fixes) | `DraftRepairPlan` (unapproved) |
| **Repair Agent** (Hardened âœ…) | Bounded repair executor - executes ONLY human-approved repairs | `RepairExecutionLog` (hash-locked) |
| **Forge Conductor** | State machine orchestrator - enforces "one agent at a time" rule | State transitions |

**Verification Executor Hardened (NEW - Jan 13, 2026)** ğŸ†•:
- **Authority**: VERIFICATION_EXECUTION_AUTHORITY
- **Purpose**: Execute verification steps exactly as specified and record objective truth
- **Intelligence Level**: ZERO (no interpretation, no helping, no retries)
- **Contract Schema**: `VerificationResultContract` with deterministic hash-locking
- **24 Forbidden Actions**: inventSteps, modifyCommands, retryFailedSteps, interpretResults, maskFailures, etc.
- **7 Allowed Actions**: loadHashApprovedInstructions, executeCommands, captureOutputs, recordMetadata, persistResults, emitEvents, haltOnFatalError
- **Context Isolation**: Only reads approved BuildPrompt + ExecutionPlan + ProjectRuleSet (all hash-locked)
- **Sequential Execution**: Runs verification commands one at a time, STOPS IMMEDIATELY on first failure
- **Determinism**: Same criteria â†’ same commands â†’ same execution order â†’ same hash
- **Philosophy**: "Verification is mechanical truth, not interpretation. If this agent ever helps, Forge is compromised."
- **Public API**: `execute(appRequestId)`
- **Status**: 10/10 constitutional tests passing

**Verification Report Generator Hardened (NEW - Jan 13, 2026)** ğŸ†•:
- **Authority**: VERIFICATION_REPORT_AUTHORITY
- **Purpose**: Mechanical projection of VerificationResult into human-readable format
- **Intelligence Level**: ZERO (no interpretation, no judgment, no recommendations)
- **Judgment Level**: ZERO (no verdict power)
- **Contract Schema**: `VerificationReportContract` with deterministic hash-locking
- **17 Forbidden Actions**: reRunVerification, interpretResults, suggestFixes, maskFailures, declarePASS/FAIL, etc.
- **6 Allowed Actions**: loadHashApprovedVerificationResult, projectDataVerbatim, computeSHA256Hash, persistImmutableReport, emitAuditEvent
- **Context Isolation**: Only reads hash-locked VerificationResult (status='approved' AND resultHash != null)
- **Pure Projection**: Projects verification steps verbatim (no summarization, no interpretation)
- **Constitutional Footer**: "This report is a mechanical projection of immutable verification results. It contains no interpretation, judgment, or recommendation."
- **Philosophy**: "If this agent ever 'helps,' Forge is lying."
- **Public API**: `generate(appRequestId)`
- **Status**: 10/10 constitutional tests passing

**Repair Plan Generator (Jan 14, 2026)** âœ…:
- **Authority**: REPAIR_PLANNING_AUTHORITY
- **Purpose**: Decision support agent that proposes repair options (NOT execution)
- **Intelligence Level**: ADVISORY (can propose solutions but cannot execute)
- **Key Principle**: Generates multiple repair options for human selection
- **21 Forbidden Actions**: executeRepair, modifyCode, autoFix, retryWithoutApproval, etc.
- **Output**: DraftRepairPlan with candidate repairs (status='unapproved', NOT executable)
- **Human Gate**: ALWAYS requires explicit human selection before execution
- **Status**: Fully integrated with Phase 10 closed-loop âœ…

**Repair Agent Hardened (Jan 14, 2026)** âœ…:
- **Authority**: REPAIR_EXECUTION_AUTHORITY (Tier 5.75)
- **Purpose**: Bounded repair executor - executes ONLY human-approved RepairPlan actions
- **Intelligence Level**: ZERO (mechanical execution only, NO creative problem-solving)
- **Autonomy Level**: ZERO (no decisions, no interpretations, no suggestions)
- **Philosophy**: "The Repair Agent is a torque wrench, not a mechanic."
- **21 Forbidden Actions**: generateCode, suggestFixes, retryOnFailure, modifyScope, etc.
- **8 Allowed Actions**: readApprovedRepairPlan, validatePreconditions, executeAction, etc.
- **RepairAction Contract**: Three operation types (replace_content, replace_lines, append)
- **Safety Guarantees**:
  - All inputs hash-locked and human-approved
  - Halts immediately on ANY violation
  - No retry or recovery logic
  - No rollback capability
- **Critical Safety Invariant**: Even malicious/buggy LLM plugged in = system stays safe
- **Test Results**: 10/10 constitutional tests PASSING
- **Phase 10 Integration**: Fully integrated and validated in end-to-end closed-loop test
- **Status**: Production-ready âœ…

**Forge Conductor** (Implemented Jan 11, 2026):
- **Purpose**: Deterministic orchestration with lock/unlock mechanism
- **ALLOWED_TRANSITIONS**: Whitelist enforcing single-agent-at-a-time execution
- **Methods**: `pauseForHuman()`, `lock()`, `unlock()` for human approval gates
- **Guarantees**: No parallel execution, no skipped steps, complete dependency tracking

---

## ğŸ”— Hash Chain Integrity

Every artifact is **hash-locked** (SHA-256) after human approval, creating an immutable audit trail:

```
Base Prompt (SHA-256)
  â†“
Founder Answers (SHA-256)
  â†“
Planning Docs (SHA-256)
  â†“
Screen Index (SHA-256)
  â†“
Screen Definitions (SHA-256)
  â†“
VRA Contracts (SHA-256)
  â†“
DVNL Contracts (SHA-256)
  â†“
VCA Contracts (SHA-256)
  â†“
Mockups (SHA-256)
  â†“
Project Rules (SHA-256)
  â†“
Build Prompt Contracts (SHA-256) â† NEW: contractHash + contractJson
  â†“
Execution Plan Contracts (SHA-256) â† NEW: contractHash + contractJson + buildPromptHash
  â†“
Execution Logs (SHA-256) â† NEW: logHash (excludes timestamps for determinism)
  â†“
Verification Result (SHA-256) â† NEW: resultHash (mechanical truth, PASSED or FAILED)
  â†“
Verification Report (SHA-256) â† NEW: reportHash (human-readable projection)
  â†“
Completion Report (SHA-256) â† NEW: reportHash (binary verdict: COMPLETE or NOT_COMPLETE)
  â†“
Working Code âœ…
```

**Benefits**:
- Complete traceability from idea to implementation
- Tamper detection (any modification breaks the chain)
- Reproducible builds (same inputs = same outputs)
- Audit compliance (who approved what, when)

---

## ğŸ›¡ï¸ Phase 10 Invariants (Frozen Forever)

**Status**: FROZEN as of January 11, 2026

These five guarantees define Forge's credibility and **MUST NEVER be weakened**:

### 1. **No Silent Completion**
Apps cannot be marked "completed" without passing verification.

### 2. **No Silent Failures**
All verification failures are visible to users with clear, actionable messages.

### 3. **Bounded Self-Healing**
- Maximum 5 repair attempts
- Must re-verify after each repair
- Cannot bypass verification checks
- No infinite loops

### 4. **Human Control**
- No auto-approval of executions
- No forced continuations
- No automatic downloads of failed apps
- Users always decide next actions

### 5. **Ratchet Rule**
Verification rules may only be **strengthened** (more checks, stricter rules) or remain unchangedâ€”never relaxed or bypassed.

**See [docs/INVARIANTS.md](docs/INVARIANTS.md) for complete specification.**

---

## ğŸ¬ Complete Workflow: Idea â†’ Working App

```
1. User describes app in plain English
   â†“
2. Foundry Architect asks 8 clarifying questions
   â†“
3. Synthetic Founder proposes answers
   â†’ [Human Approval #1] âœ‹
   â†“
4. Product Strategist creates master plan
   â†“
5. Screen Cartographer maps all screens
   â†’ [Human Approval #2] âœ‹
   â†“
6. Journey Orchestrator defines user flows
   â†“
7. Visual Rendering Authority creates expansion contract
   â†’ [Human Approval #3] âœ‹
   â†“
8. Deterministic Visual Normalizer constrains visual complexity (NEW!)
   â†’ [Human Approval #3.5] âœ‹
   â†“
9. Visual Forge generates pixel-perfect mockups
   â†’ [Human Approval #4] âœ‹
   â†“
10. Constraint Compiler locks architecture rules
   â†’ [Human Approval #5] âœ‹
   â†“
11. Build Prompt Engineer creates code prompts
   â†“
12. Execution Planner breaks into micro-tasks
   â†“
13. Forge Implementer writes actual code
   â†“
14. Phase 10 Verification validates everything
   â†“
15. Self-Healing fixes issues (max 5 attempts)
   â†“
16. Completion Auditor confirms quality
   â†“
17. âœ… Working app ready for download!
   â†’ [Human Escalation #6] âœ‹ (only if verification fails after max attempts)
```

**Total Human Approval Gates**: 6 strategic checkpoints
**AI Quality Guarantee**: Verified or transparently failed (no silent breakage)

---

## ğŸ’¡ Why Forge is Different

### vs. Other AI Code Generators
| Feature | Them | Forge |
|---------|------|-------|
| Quality Guarantee | âŒ Ship broken code silently | âœ… Verification before completion |
| Mockup Quality | âŒ Basic/inconsistent | âœ… Production-ready (VCRA + Playwright) |
| Code Reuse | âŒ Mockups not reusable | âœ… Mockup code = implementation starting point |
| Self-Healing | âŒ No auto-repair | âœ… Up to 5 bounded repair attempts |
| Human Control | âŒ Black box | âœ… 6 approval gates with full transparency |
| Traceability | âŒ No audit trail | âœ… Complete hash chain from idea to code |
| Architecture | âŒ Single-shot generation | âœ… 15-agent assembly line |

### vs. ChatGPT/Claude Direct
| Feature | Them | Forge |
|---------|------|-------|
| Workflow | âŒ One-shot, no checkpoints | âœ… 12-phase assembly line |
| Verification | âŒ None | âœ… Automated + self-healing |
| Visual Expansion | âŒ Arbitrary decisions | âœ… VRA with closed vocabularies |
| Determinism | âŒ Non-deterministic | âœ… Temperature â‰¤ 0.3, stable serialization |
| Mockups | âŒ Manual or blurry AI images | âœ… VCRA-generated code + Playwright (perfect text) |
| Code Reuse | âŒ Start from scratch | âœ… Mockup code = implementation starting point |

### vs. No-Code Tools
| Feature | Them | Forge |
|---------|------|-------|
| Customization | âŒ Limited | âœ… Full code ownership |
| Complexity | âŒ Simple apps only | âœ… Any complexity (with right prompts) |
| Vendor Lock-in | âŒ Tied to platform | âœ… Standard code files (HTML/JS/CSS) |
| AI Intelligence | âŒ Rule-based | âœ… GPT-5 + Claude Sonnet 4.5 |

---

## ğŸ“ˆ Performance Metrics (January 14, 2026)

### Agent Test Coverage
- **All Hardened Agents**: 10/10 test pass rate
- **Repair Agent Hardened**: 10/10 constitutional tests âœ… ğŸ†•
- **Phase 10 Closed-Loop**: All 8 steps PASSING âœ… ğŸ†•
- **Constitutional Audit**: 17/17 agents validated âœ… ğŸ†•
- **Visual Rendering Authority**: 10/10 with real Claude API
- **Deterministic Visual Normalizer**: 10/10 with real Claude API
- **Visual Forge**: 10/10 production hardening tests
- **Journey Orchestrator**: 10/10 determinism tests
- **Verification Executor**: 10/10 constitutional tests
- **Verification Report Generator**: 10/10 constitutional tests

### Image Generation Performance
- **Model**: GPT Image 1.5 (primary)
- **Fallback**: DALL-E 3 (smart fallback)
- **Speed**: 34 seconds for 3.06 MB high-quality mockups
- **Quality**: ChatGPT-level output fidelity

### Development Velocity (4-Day Sprint)
- **Commits**: 40+ production commits
- **New Agents**: 6 (VRA, DVNL, VCA, VCRA, Verification Executor, Verification Report Generator)
- **Test Coverage**: 10/10 across all hardened agents
- **Documentation**: 15+ comprehensive markdown files
- **Phase 10**: Full constitutional hardening with ZERO intelligence verification ğŸ†•

---

## ğŸ Getting Started

### For Non-Technical Users

**What Forge Can Do for You:**
- âœ… Simple web apps (task managers, calculators, landing pages)
- âœ… Static websites (portfolios, small business pages)
- âœ… Working prototypes (validate ideas before hiring developers)
- âœ… Learning examples (see how things are built)

**What You'll Get:**
- Professional mockups (ChatGPT-level quality)
- Working code files (HTML, JavaScript, CSS)
- Verification report (what works, what doesn't)
- Self-healed badge (if auto-fixes were applied)

**What You'll Need:**
- Clear idea of what you want to build
- Patience (building takes 5-15 minutes)
- Willingness to approve checkpoints (6 approval gates)

**Example Prompts:**
- "Build a personal task manager with add, edit, and delete features"
- "Create a simple website for my bakery with menu and contact info"
- "Make a calculator web app that can add, subtract, multiply, and divide"

**Quick Start:**
1. Run Forge â†’ Open Web UI (http://localhost:5173)
2. Create Project â†’ Click "Build an App"
3. Approve checkpoints (6 gates throughout process)
4. Wait for verification â†’ Download working app âœ…

---

### For Developers

Forge is a **backend-first platform** designed for production. Built with TypeScript strict mode, comprehensive testing, and enterprise-grade architecture.

#### Prerequisites

- Node.js 18+
- npm (comes with Node.js)

#### Installation

```bash
# Clone repository
git clone https://github.com/IlyasuSeidu/forge.git
cd forge

# Install dependencies
npm install

# Run database migrations
npm run db:migrate

# Type check
npm run typecheck
```

#### Development

**Backend Server:**
```bash
npm run dev
# Server at http://localhost:3000
```

**Web UI:**
```bash
cd apps/web
npm install
npm run dev
# UI at http://localhost:5173 (auto-proxies to backend)
```

#### Environment Variables

**Required for AI features:**
```bash
# Claude AI (code generation)
export ANTHROPIC_API_KEY=your_claude_key

# OpenAI (mockup generation)
export OPENAI_API_KEY=your_openai_key

# Optional: Override models
export CLAUDE_MODEL=claude-3-5-sonnet-20241022
```

**Optional configuration:**
```bash
export PORT=3000              # Server port
export HOST=0.0.0.0           # Server host
export NODE_ENV=development   # Environment
export LOG_LEVEL=info         # Log level
```

**Get API Keys:**
- Claude: https://console.anthropic.com/
- OpenAI: https://platform.openai.com/

#### Production Build

```bash
npm run build  # Compile TypeScript
npm start      # Start production server
```

---

## ğŸ›ï¸ Architecture

### Technology Stack

**Backend:**
- **Runtime**: Node.js 18+
- **Language**: TypeScript (strict mode)
- **Framework**: Fastify (chosen over Express for better TypeScript support, performance, and modern architecture)
- **Database**: SQLite (dev) â†’ PostgreSQL (production)
- **ORM**: Prisma
- **Logging**: Pino (structured JSON logs)

**Frontend:**
- **Framework**: React 18 + TypeScript
- **Build Tool**: Vite
- **Styling**: Tailwind CSS
- **Routing**: React Router 6

**AI Integrations:**
- **Code Generation**: Anthropic Claude Sonnet 4.5
- **Mockup Generation**: OpenAI GPT Image 1.5 (primary) + DALL-E 3 (fallback)
- **Planning**: GPT-5 (Tier 1-3 agents)

### Project Structure

```
forge/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ server/                    # Backend API
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ agents/            # 12 specialized agents
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ foundry-architect-hardened.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ synthetic-founder-hardened.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ product-strategist-hardened.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ screen-cartographer-hardened.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ journey-orchestrator-hardened.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ visual-rendering-authority.ts         # NEW
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ deterministic-visual-normalizer.ts    # NEW
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ visual-forge-hardened.ts              # UPGRADED
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ constraint-compiler.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ build-prompt-engineer.ts              # Legacy
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ build-prompt-engineer-hardened.ts     # NEW (Production)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ execution-planner.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ forge-implementer.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ completion-auditor.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ repair-agent.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ agent-registry.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ models/            # Domain models
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/            # HTTP route handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ services/          # Business logic
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ forge-conductor.ts  # NEW
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ verification-service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/             # Utilities
â”‚   â”‚   â”‚   â”œâ”€â”€ server.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â””â”€â”€ web/                       # React Web UI
â”œâ”€â”€ docs/                          # Documentation
â”‚   â”œâ”€â”€ AGENT-TAXONOMY.md          # 12-agent framework
â”‚   â”œâ”€â”€ INVARIANTS.md              # Phase 10 frozen rules
â”‚   â”œâ”€â”€ FORGE-CONDUCTOR-IMPLEMENTATION.md
â”‚   â”œâ”€â”€ VISUAL_RENDERING_AUTHORITY.md
â”‚   â”œâ”€â”€ BUILD_PROMPT_EXECUTION_CONTRACT.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ packages/shared/               # Shared utilities
â”œâ”€â”€ prisma/                        # Database schema & migrations
â”œâ”€â”€ workspaces/                    # Generated apps output
â”œâ”€â”€ VISUAL_RENDERING_AUTHORITY.md  # VRA specification
â”œâ”€â”€ DETERMINISTIC_VISUAL_NORMALIZER.md  # DVNL specification (NEW)
â”œâ”€â”€ VISUAL_FORGE_HARDENED.md       # Visual Forge upgrades
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

### Why This Architecture?

**Specialization Over Generalization:**
- Each agent has a single, non-overlapping mandate
- No "do everything" agents that produce inconsistent results
- Clear boundaries enable deterministic testing (10/10 pass rates)
- Constitutional authorities with explicit allowed/forbidden actions

**Auditability:**
- Every decision stored and traceable via hash chain
- Complete event log from idea to implementation
- SHA-256 hashing prevents tampering

**Verification Lock:**
- Phase 10 cannot be bypassed (frozen invariants)
- Self-healing with bounded attempts (no infinite loops)
- Human escalation when auto-repair fails

**Coordination Discipline:**
- Forge Conductor prevents "agent soup" chaos
- Single-agent-at-a-time execution (ALLOWED_TRANSITIONS whitelist)
- Human approval gates at strategic junctures

**Production Hardening:**
- PromptEnvelope validation (authority enforcement)
- Context isolation (hash-based artifact access only)
- Determinism guarantees (temperature â‰¤ 0.3, stable serialization)
- Failure escalation (no silent fallbacks)

---

## ğŸ“š Domain Models

### Core Entities

**Project**: User's application being built
```typescript
{
  id: string;
  name: string;
  description: string;
  createdAt: Date;
  updatedAt: Date;
}
```

**Task**: Single unit of work within a project
```typescript
{
  id: string;
  projectId: string;
  title: string;
  description: string;
  status: 'pending' | 'in_progress' | 'completed' | 'failed';
  createdAt: Date;
  updatedAt: Date;
}
```

**Execution**: Single run of the agent system
```typescript
{
  id: string;
  projectId: string;
  status: 'idle' | 'pending_approval' | 'running' | 'paused' | 'completed' | 'failed';
  startedAt: Date | null;
  finishedAt: Date | null;
}
```

**Approval**: Human checkpoint before critical actions
```typescript
{
  id: string;
  projectId: string;
  executionId: string;
  taskId: string | null;
  type: 'execution_start' | 'task_completion';
  status: 'pending' | 'approved' | 'rejected';
  reason: string | null;
  createdAt: Date;
  resolvedAt: Date | null;
}
```

**Verification**: Quality validation check
```typescript
{
  id: string;
  appRequestId: string;
  executionId: string;
  status: 'pending' | 'passed' | 'failed';
  errors: string[] | null;
  attempt: number;  // Max 5 attempts
  createdAt: Date;
}
```

**Artifact**: File or directory created by agents
```typescript
{
  id: string;
  projectId: string;
  executionId: string | null;
  taskId: string | null;
  path: string;
  type: 'file' | 'directory';
  hashSHA256: string | null;  // Hash-chain integrity
  createdAt: Date;
}
```

---

## ğŸ”Œ API Reference

### Health Check

**GET /health**

Returns server health status.

```json
{
  "status": "healthy",
  "timestamp": "2026-01-12T10:30:00.000Z",
  "uptime": 3600.5
}
```

### Projects

**POST /api/projects**

Create a new project.

Request:
```json
{
  "name": "My Todo App",
  "description": "A simple todo application"
}
```

Response (201):
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "name": "My Todo App",
  "description": "A simple todo application",
  "createdAt": "2026-01-12T10:30:00.000Z",
  "updatedAt": "2026-01-12T10:30:00.000Z"
}
```

**GET /api/projects**

List all projects (sorted by creation date, newest first).

**GET /api/projects/:id**

Get a specific project.

### Tasks

**POST /api/projects/:id/tasks**

Create a new task for a project.

Request:
```json
{
  "title": "Build user interface",
  "description": "Create responsive UI with React"
}
```

**GET /api/projects/:id/tasks**

List all tasks for a project.

### Executions

**POST /api/projects/:id/executions**

Start a new execution (requires approval).

**Behavior**:
- Creates execution with "pending_approval" status
- Creates approval request
- Execution does NOT start until approved
- Prevents concurrent executions per project

Response (201):
```json
{
  "id": "770e8400-e29b-41d4-a716-446655440002",
  "projectId": "550e8400-e29b-41d4-a716-446655440000",
  "status": "pending_approval",
  "startedAt": null,
  "finishedAt": null
}
```

**GET /api/projects/:id/executions/:executionId**

Get execution status.

**GET /api/projects/:id/executions/:executionId/events**

Get all events for an execution (ordered by time).

**POST /api/projects/:id/executions/:executionId/pause**

Pause a running execution.

**POST /api/projects/:id/executions/:executionId/resume**

Resume a paused execution.

### Approvals

**GET /api/projects/:id/approvals**

List all approvals for a project.

**POST /api/approvals/:approvalId/approve**

Approve and trigger the associated action.

Request (optional):
```json
{
  "reason": "Looks good, approved"
}
```

**POST /api/approvals/:approvalId/reject**

Reject and prevent the associated action.

Request (optional):
```json
{
  "reason": "Needs more review"
}
```

### Artifacts

**GET /api/projects/:id/artifacts**

List all artifacts for a project.

Query Parameters:
- `executionId` (optional) - Filter by execution
- `taskId` (optional) - Filter by task

**GET /api/projects/:id/executions/:executionId/artifacts**

List artifacts from a specific execution.

### Error Responses

All errors follow a consistent format:

```json
{
  "error": {
    "message": "Project with id 'invalid-id' not found",
    "code": "NOT_FOUND",
    "statusCode": 404
  }
}
```

Common status codes:
- `400` - Validation error
- `404` - Resource not found
- `422` - Business rule violation
- `500` - Internal server error

---

## ğŸ§ª Testing the API

Using curl:

```bash
# Health check
curl http://localhost:3000/health

# Create a project
curl -X POST http://localhost:3000/api/projects \
  -H "Content-Type: application/json" \
  -d '{"name": "My App", "description": "A test application"}'

# List projects
curl http://localhost:3000/api/projects

# Create a task (replace PROJECT_ID)
curl -X POST http://localhost:3000/api/projects/PROJECT_ID/tasks \
  -H "Content-Type: application/json" \
  -d '{"title": "First task", "description": "Do something"}'

# Start execution (replace PROJECT_ID)
curl -X POST http://localhost:3000/api/projects/PROJECT_ID/executions

# List approvals (replace PROJECT_ID)
curl http://localhost:3000/api/projects/PROJECT_ID/approvals

# Approve an approval (replace APPROVAL_ID)
curl -X POST http://localhost:3000/api/approvals/APPROVAL_ID/approve \
  -H "Content-Type: application/json" \
  -d '{"reason": "Approved"}'
```

---

## ğŸ”’ Security & Safety

### Workspace Isolation

Each project gets its own isolated directory:
```
/tmp/forge-workspaces/
  â””â”€â”€ {projectId}/
      â”œâ”€â”€ src/
      â”œâ”€â”€ config/
      â””â”€â”€ output/
```

**Guarantees**:
- âœ… Path validation (prevents `../../etc/passwd`)
- âœ… Absolute path rejection
- âœ… Workspace confinement (all paths must resolve within workspace)
- âœ… Empty path rejection

### AI Safety Boundaries

- âœ… **Workspace Isolation**: AI can ONLY create files in project workspace
- âœ… **No Shell Execution**: Cannot run bash commands or execute code
- âœ… **No Network Access**: Cannot make HTTP requests or connect to databases
- âœ… **No Package Installation**: Cannot install npm/pip dependencies
- âœ… **Approval Required**: All executions need human approval
- âœ… **Audit Trail**: All AI actions logged as execution events

### Privacy

**What Forge Knows**:
- Your app descriptions (prompts)
- Files it creates for you

**What Forge DOES NOT Access**:
- Your personal files or folders
- Your network or internet
- External databases or services
- Your computer's system files

---

## ğŸ“– Documentation

Comprehensive documentation in `/docs`:

### Constitutional Agents & Core System
- [**CONSTITUTIONAL_AUDIT_REPORT.md**](CONSTITUTIONAL_AUDIT_REPORT.md) - Final audit certifying production readiness ğŸ†•
- [**REPAIR_AGENT_HARDENED.md**](docs/REPAIR_AGENT_HARDENED.md) - Repair Agent specification ğŸ†•
- [**AGENT-TAXONOMY.md**](docs/AGENT-TAXONOMY.md) - Complete 17-agent framework & tier system
- [**INVARIANTS.md**](docs/INVARIANTS.md) - Phase 10 frozen guarantees
- [**FORGE-CONDUCTOR-IMPLEMENTATION.md**](docs/FORGE-CONDUCTOR-IMPLEMENTATION.md) - State machine orchestrator

### Visual Intelligence Pipeline
- [**VISUAL_RENDERING_AUTHORITY.md**](VISUAL_RENDERING_AUTHORITY.md) - VRA specification
- [**DETERMINISTIC_VISUAL_NORMALIZER.md**](DETERMINISTIC_VISUAL_NORMALIZER.md) - DVNL specification
- [**VISUAL_FORGE_HARDENED.md**](VISUAL_FORGE_HARDENED.md) - Visual Forge upgrades

### Manufacturing & Execution
- [**BUILD_PROMPT_ENGINEER_HARDENED.md**](docs/BUILD_PROMPT_ENGINEER_HARDENED.md) - MBOM constitutional authority ğŸ†•
- [**BUILD_PROMPT_EXECUTION_CONTRACT.md**](docs/BUILD_PROMPT_EXECUTION_CONTRACT.md) - Build prompt engineering (Legacy)
- [**EXECUTION_PLANNER.md**](docs/EXECUTION_PLANNER.md) - Micro-execution decomposition
- [**FORGE_IMPLEMENTER.md**](docs/FORGE_IMPLEMENTER.md) - Code implementation

### Verification & Quality Assurance
- [**VERIFICATION_EXECUTOR_HARDENED.md**](docs/VERIFICATION_EXECUTOR_HARDENED.md) - Adversarial truth engine ğŸ†•
- [**VERIFICATION_REPORT_GENERATOR_HARDENED.md**](docs/VERIFICATION_REPORT_GENERATOR_HARDENED.md) - Pure projection report generator ğŸ†•
- [**COMPLETION_AUDITOR.md**](docs/COMPLETION_AUDITOR.md) - Quality auditing

### Framework Assembly Layer (NEW - Jan 14, 2026) ğŸ†•
- [**FRAMEWORK_ASSEMBLY_NEXTJS.md**](docs/FRAMEWORK_ASSEMBLY_NEXTJS.md) - Next.js Pack deterministic manufacturing jig

### Testing & Deployment
- [**E2E-TESTING-GUIDE.md**](docs/E2E-TESTING-GUIDE.md) - End-to-end testing
- [**GETTING_STARTED.md**](GETTING_STARTED.md) - Quick start guide
- [**DEPLOY.md**](DEPLOY.md) - Deployment instructions

---

## ğŸ¤ Contributing

This project prioritizes:

- **Correctness** over speed
- **Clarity** over cleverness
- **Extensibility** over premature optimization
- **Production readiness** over prototyping

**CRITICAL**: All contributions must respect the Core Invariants documented in [docs/INVARIANTS.md](docs/INVARIANTS.md). Changes that bypass or weaken verification will be rejected.

---

## ğŸ“Š Recent Commits (Jan 10-12, 2026)

### Latest (Jan 12, 2026)
- `fa10b49` - Fix VRA conductor integration + comprehensive E2E test
- `e522674` - Complete VRA Phase 2: Visual Forge consumes contracts
- `32bcaf0` - Implement Visual Rendering Authority (Tier 3.5)
- `6d1da33` - Upgrade Visual Forge to GPT Image 1.5
- `d2a5bb6` - Add real OpenAI DALL-E 3 API integration

### Previous Days
- Journey Orchestrator determinism fix (10/10 tests)
- Forge Conductor implementation
- Build Prompt Engineer with execution contracts
- Phase 10 Invariants freeze
- Self-healing RepairAgent
- Static verification engine

**See full commit history**: https://github.com/IlyasuSeidu/forge/commits/main

---

## ğŸ¯ Competitive Advantages

### 1. **Quality Guarantee**
Unlike competitors, Forge catches broken code BEFORE marking apps complete.

### 2. **ChatGPT-Level Mockups**
GPT Image 1.5 + VRA contracts = professional-quality visual outputs.

### 3. **Hash-Chain Traceability**
Complete audit trail from idea to implementation with SHA-256 integrity.

### 4. **Bounded Self-Healing**
Automatic repair attempts (max 5) with re-verification after each fix.

### 5. **Human Control**
6 strategic approval gates ensure you're always in the driver's seat.

### 6. **Production-Grade Architecture**
12-agent assembly line with deterministic coordination (not "agent soup").

### 7. **Frozen Invariants**
Phase 10 guarantees that can NEVER be weakenedâ€”building long-term trust.

---

## ğŸ“œ License

MIT

---

## ğŸ™ Acknowledgments

Built with:
- **Claude Sonnet 4.5** (Anthropic) - Code generation
- **GPT Image 1.5** (OpenAI) - Mockup generation
- **DALL-E 3** (OpenAI) - Fallback image generation
- **Fastify** - Backend framework
- **React 18** - Frontend framework
- **Prisma** - Database ORM
- **TypeScript** - Type safety

---

**Production-Grade AI Application Factory**
*Natural Language â†’ Verified, Working Apps*

ğŸ”— https://github.com/IlyasuSeidu/forge
